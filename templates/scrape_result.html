{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Preview Scraped Questions</h2>
    <form method="POST" action="{{ url_for('save_scraped') }}" id="scrapeForm">
        <input type="hidden" name="topic" value="{{ topic }}">
        <input type="hidden" name="difficulty" value="{{ difficulty }}">
        
        {% for q in questions %}
        <div class="card mt-3 p-3 question-card">
            <h5>Q{{ loop.index }}: {{ q.question_text }}</h5>
            <ul>
                <li>A) {{ q.option_a }}</li>
                <li>B) {{ q.option_b }}</li>
                <li>C) {{ q.option_c }}</li>
                <li>D) {{ q.option_d }}</li>
            </ul>
            <p><b>Correct:</b> {{ q.correct_option }}</p>

            <!-- Hidden fields for submission -->
            <input type="hidden" name="questions[]" value="{{ q.question_text }}">
            <input type="hidden" name="option_a[]" value="{{ q.option_a }}">
            <input type="hidden" name="option_b[]" value="{{ q.option_b }}">
            <input type="hidden" name="option_c[]" value="{{ q.option_c }}">
            <input type="hidden" name="option_d[]" value="{{ q.option_d }}">
            <input type="hidden" name="correct_option[]" value="{{ q.correct_option }}">

            <!-- Remove button -->
            <button type="button" class="btn btn-danger btn-sm mt-2 remove-btn">Remove</button>
        </div>
        {% endfor %}

        <button type="submit" class="btn btn-success mt-4">Save All to Database</button>
    </form>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".remove-btn").forEach(btn => {
        btn.addEventListener("click", function() {
            const card = this.closest(".question-card");
            card.remove(); // removes the card & its hidden inputs
        });
    });
});
</script>
{% endblock %}
